# 展讯平台sprintf在真机上使用%s时参数为NULL会导致死机或者输出无效字符

## 当buffer很小时直接死机，代码如下：
```
void log(const uint8 *buf, int len) {
	char str[1024] = {0};
	char *strp = str;
	uint8 *bufp = buf;
	int slen = 0;
	char *fmt = "0x%02x, ";

	SCI_TRACE_LOW("{");

	do {
		if (bufp == buf + len - 1) fmt = "0x%02x";

		slen = sprintf(strp, fmt, *bufp++);
		strp += slen;

		if (!((bufp - buf) % 10)) {
			*strp = 0;
			SCI_TRACE_LOW("%s", str);
			strp = str;
		}
	} while (bufp < buf + len);

	if (strp != str) {
		*strp = 0;
		SCI_TRACE_LOW("%s", str);
	}

	SCI_TRACE_LOW("}");
}

const uint8 buf[10] = {0};
char *str = NULL;
sprintf(buf, "%s", str);
log(buf, 10);
```

## 增大buffer为1024，输出无效字符
```
0x18, 0xf0, 0x9f, 0xe5, 0x18, 0xf0, 0x9f, 0xe5, 0x18, 0xf0, 
0x9f, 0xe5, 0x18, 0xf0, 0x9f, 0xe5, 0x18, 0xf0, 0x9f, 0xe5, 
0x18, 0xf0, 0x9f, 0xe5, 0x18, 0xf0, 0x9f, 0xe5, 0x18, 0xf0, 
0x9f, 0xe5, 0x08, 0xe7, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
...
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
```

## 在模拟器上输出字符串：(null)

# 结论：

## sprintf在使用%s占位符时，对应参数一定要做NULL检查
